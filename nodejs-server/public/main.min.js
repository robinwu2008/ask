In.ready("bootstrapjs3","bootstrapcss3","angular","jquery","jquery","jquery-ui","bootstrap-jquery-ui-css-1.9.2","jquery-highlighter",function(){var f=angular.module("myapp",[]);f.controller("pnController",e);f.controller("mainController",g);var d="";var c=$("#tb").length;var b=0;var a=1;function g(h,i){h.addtrs=function(){h.tr.push(a++)};h.priceOption="1";h.priceOptionChange=function(j){console.log("修改价格策略",j);h.priceOption=j};h.$on("changepnnumber",function(j,k){h.allnum=countnum(".pnnumber")});h.$on("addtrs",function(j){setTimeout("addtrsfun()",200)})}function e(h,j){h.search=function(k){i(k)};h.change=function(k){h.$emit("changepnnumber",k)};h.getunitPrice=function(k){console.log(k);var l=0;if(isNaN(parseInt(h.unitPrice))){h.unitPrice=0}if(h.mfs!=null&&h.mfs.length>0){}else{return l}if(h.priceOption=="1"){l=0.4}else{if(h.priceOption=="digikey"){l=0.91}else{l=0.911}}if(k>100){l=l-0.1}else{if(k>200){l=l-0.2}else{if(k>200){l=l-0.2}else{if(k>400){l=l-0.3}else{if(k>600){l=l-0.4}}}}}h.unitPrice=l;return l};h.load=function(){b++;if(b>=c){$("input[qegooautoComplete=auto]").autocomplete({autoFocus:false,position:{my:"left top",at:"left bottom"},source:function(l,k){$.get($("input[qegooautoComplete=auto]").attr("dataUrl")+l.term,function(m){k($.map(m,function(n){return{label:n,value:n}}))})},select:function(k,l){$(this).val(l.item.value);$(this).trigger("change");$(this).next().trigger("click")},minLength:1})}};function i(k){h.digikey=[];h.mouser=[];h.element=[];h.digikeylength=0;h.mouserlength=0;h.elementlength=0;try{j.get("/getmfsandpn?pn="+k).success(function(m){h.mfs=m;h.mfslength=m.length;h.$emit("addtrs");h.$emit("changepnnumber",1)})}catch(l){}}}});function addtrsfun(){if($(".maintr:last td:eq(5)").text().trim().length>0){$(".addtr").trigger("click")}}function hidtr(a){var b=a-1;$(".tr"+b).hidden()}function log(a){console.log(a)}function countnum(c){var b=0;for(var a=0;a<$(c).length;a++){if(!isNaN(parseInt(jQuery($(c).get(a)).val()))){b=b+parseInt(jQuery($(c).get(a)).val())}else{}}return b};